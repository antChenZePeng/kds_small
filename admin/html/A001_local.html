{% extends "local_mul.html" %}
{% block MUL_BTNS %}
<input type="submit" class="btn btn-success span2" name="add_save" value="{{BTNS}}" />
{% endblock %}
{% block mMul_Page_1 %}
<div class="panel-body">
    <div class="row">

        <div class="form-group">
            <label class="col-sm-3 control-label">OSS开启:</label>
            <div class="col-sm-3">
                <select name="ctype" class="form-control" onchange='showctype(this)'>
                    <option value="0" {{'selected="selected"' if '0' == item.ctype|string}}>七牛云OSS</option>
                    <option value="1" {{'selected="selected"' if '1' == item.ctype|string}}>阿里云OSS</option>
                    <option value="2" {{'selected="selected"' if '2' == item.ctype|string}}>平台存储</option>
                </select>
            </div>
        </div>
    </div>
    <div class="row" id="show_ctype" style="display:none;">
        <div class="form-group">
            <label class="col-sm-3 control-label">access_key:</label>
            <div class="col-sm-8">
                <input type="text" class="form-control"  name="access_key" value="{{item.access_key}}" style="width:60%"/>(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">secret_key:</label>
            <div class="col-sm-8">
                <input type="text" class="form-control"  name="secret_key" value="{{item.secret_key}}"  style="width:60%" />(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">bucket_name:</label>
            <div class="col-sm-5">
                <input type="text" class="form-control"  name="cname" value="{{item.cname}}"  />(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">外链默认域名:</label>
            <div class="col-sm-8">
                <input type="text" class="form-control"  name="domain_url" value="{{item.domain_url}}"  style="width:50%"/>(会被加密保存)</br>
			    <font style="color:red;">如：http://cdn.janedao.cn/或https://cdn.janedao.cn/<br>注意：小程序海报功能需开启https</font>

            </div>

        </div>

        <div class="form-group" id="ali" style="display:none;">
            <label class="col-sm-3 control-label">endpoint:</label>
            <div class="col-sm-8">
                <input type="text" class="form-control" name="endpoint" value="{{item.endpoint}}" style="width:50%"/></br>
			    <font style="color:red;">阿里云OSS独用,非阿里云OSS请留空</font>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-6 control-label">
                <font style="color:red;">注意：修改保存后请上传一张图，确认配置是否有误</font>
            </label>

        </div>
    </div>

</div>

<script>

    $(function(){
        var ctype =$('select[name=ctype]').val();
        if (ctype!='2'){
            $('#show_ctype').show();
        }
        if (ctype=='1'){
            $('#ali').show();
        }
     });

     function showctype(obj){
        var vtype=obj.value
        if (vtype!='2'){
            $('#show_ctype').show();
            if (vtype=='1'){
                $('#ali').show();
            }else{
                $('#ali').hide();
            }
        }else{
            $('#show_ctype').hide();
        }
     }


    function formcheck_2(form){
        var ctype = $('select[name=ctype]').val();
        var access_key = $('input[name=access_key]').val();
        var secret_key = $('input[name=secret_key]').val();
        var name = $('input[name=name]').val();
        var domain = $('input[name=domain]').val();
        var endpoint = $('input[name=endpoint]').val();
        if (ctype!='2'){

            if (access_key==''){
                layer.alert('access_key不能为空！')
                return false;
            }
            if (secret_key==''){
                layer.alert('secret_key不能为空！')
                return false;
            }
            if (name==''){
                layer.alert('bucket_name不能为空！')
                return false;
            }
            if (domain==''){
                layer.alert('外链默认域名不能为空！')
                return false;
            }
            if (ctype=='1' && endpoint==''){
                layer.alert('阿里云必须填写endpoint！')
                return false;
            }

        }

        return true;

    }

</script>
{% endblock %}
{% block mMul_Page_2 %}
<link href="static/web-uploader/css/uploader-image.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="static/web-uploader/js/Q.js"></script>
<script type="text/javascript" src="static/web-uploader/js/Q.Uploader.js"></script>
<script type="text/javascript" src="static/web-uploader/js/Q.Uploader.UI.Image.js"></script>
<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label">店铺名称:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="cname" value="{{item.cname}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">店铺地址:</label>
            <div class="col-sm-4">
                <input type="text" class="form-control"  name="gadds" value="{{item.gadds}}"/>(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">店铺首页分享标题:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="home_title" value="{{item.home_title}}"/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">客服电话:</label>
            <div class="col-sm-4">
                <input type="text" class="form-control"  name="phone" value="{{item.phone}}"/>(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">客服时间:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="times" value="{{item.times}}"/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">店铺logo:</label>
            <div class="col-sm-1">
                <input type="hidden" name="logo_pic_link" value="{{item.logo_pic_link}}"/>
                <div class="row">
                    <div id="container" style="position: relative;">
                        <a id="pickfiles"  style="position: relative; z-index: 1;">[选择本地文件]</a>
                    </div>
                </div>
            </div>
            <div class="col-sm-2">
                <div id="logo">
                    {% if item.logo_pic_link %}
                        <img class="col-sm-12" style="width: 100px;" src="{{item.logo_pic_link}}"/>
                    {%endif%}
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">店铺首页分享图:</label>
            <div class="col-sm-1">
                <input type="hidden" name="home_pic_link" value="{{item.home_pic_link}}"/>
                <div class="row">
                    <div id="containera" style="position: relative;">
                        <a id="pickfilesa"  style="position: relative; z-index: 1;">[选择本地文件]</a>
                    </div>
                </div>

            </div>
            <div class="col-sm-2">
                <div id="share">
                    {% if item.home_pic_link %}
                        <img class="col-sm-12" style="width: 100px;" src="{{item.home_pic_link}}"/>
                    {%endif%}
                </div>
            </div>
        </div>

    </div>

</div>
<script>

	var ids = new Array("pickfiles","pickfilesa");
	var divs = new Array("logo","share");
    var hinames = new Array("logo_pic_link","home_pic_link");

    $.each(ids,function(i,n){
        var self = this.toString();
        //实例化一个plupload上传对象
        var Uploader = Q.Uploader,
        formatSize = Q.formatSize,
        boxView = document.getElementById(""+divs[i]+"")
        var uploader = new Uploader({
            url: '/upload?viewid={{viewid}}&part=Img',
            target: document.getElementById(""+self+""),
            view: boxView,//如果去掉这个，会导致压缩效果不好
            //将auto配置为false以手动上传
            auto: true,
            dataType: "json",
            allows: ".jpg,.png,.gif,.bmp,.jpeg",
            upName: "file",
            //图片缩放
            /*scale: {
                //要缩放的图片格式
                types: ".jpg,.png,.jpeg,.bmp",
                //最大图片大小(width|height)
                maxWidth: 500
            },*/
            on: {
                //添加之前触发
                add: function (task) {
                	layer.load()
                    if (task.disabled) return layer.alert("允许上传的文件格式为：" + this.ops.allows);
                },
                upload: function (task) {
                	layer.load()
                },
                complete: function(task){
                    var jsons=task.json;
                    if(jsons){
                        $("#"+divs[i]+"").html('');
                        var innerDivHtml = '<img src="'+ task.json.url  +'" class="col-sm-12">';
                        $("#"+divs[i]+"").append(innerDivHtml);
                        $('input[name='+hinames[i]+']').val(task.json.url);
                        layer.closeAll()
                    }else{
                        //layer.alert('上传图片故障！')
                        layer.closeAll()
                    }
                }
            }
        });
        uploader.start();//
    });

</script>
<script>
    function formcheck_2(form){
        return true;

    }

</script>
{% endblock %}

{% block mMul_Page_3 %}
<div class="panel-body">
    <div class="row">
        <div class="col-sm-12">
            <div class="title_comm">
                <span class="block_blue"></span>
                <b style="color:#333;">多商铺设置(名称空白的行不会保存)</b>&emsp;&emsp;
                <a href="https://lbs.qq.com/tool/getpoint/" target="_blank" style="">跳转腾讯地图坐标拾取器https://lbs.qq.com/tool/getpoint/</a>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:4%;">序号</th>
                        <th style="text-align:center;width:21%;">商铺名称</th>
                        <th style="text-align:center;width:25%;">商铺地址(会被加密保存)</th>
                        <th style="text-align:center;width:16%;">商铺联系方式(会被加密保存)</th>
                        <th style="text-align:center;width:28%;">商铺坐标</th>
                    </tr>
                </thead>
                <tbody>

                    {% for e in item %}
                        <tr>
                            <td onclick='clickR(this);'>{{loop.index}}

                            </td>
                            <td onclick='clickR(this);'>
                                <input type='hidden' name='lid' value='{{e.id}}' />
                                <input type='text' name='cname' value='{{e.cname}}' class='form-control' style='width:100%;'/>
                            </td>
                            <td onclick='clickR(this);'>
                                <input type='text' name='address' value='{{e.address}}'  class='form-control' style='width:100%;' />
                            </td>
                            <td onclick='clickR(this);'>
                                <input type='text' name='contact' value='{{e.contact}}' class='form-control number' style='width:100%;ime-mode:Disabled;' />
                            </td>
                            <td onclick='clickR(this);'>
                                <div class='col-sm-6'>经度<input type='text' name='jd' value='{{e.jd}}' class='form-control' style='width:100%;'  /></div>
                                <div class='col-sm-6'>纬度<input type='text' name='wd' value='{{e.wd}}' class='form-control' style='width:100%;'/></div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>


</div>
<script>
function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"</td>";
	html+="<td onclick='clickR(this);'><input type='hidden' name='lid' value='' /><input type='text' name='cname' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='address' value=''  class='form-control' style='width:100%;' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='contact' value='' class='form-control number' /></td>";
    html+="<td onclick='clickR(this);'><div class='col-sm-6'>经度<input type='text' name='jd' value='' class='form-control' style='width:100%;' /></div>";
    html+="<div class='col-sm-6'>纬度<input type='text' name='wd' value='' class='form-control' style='width:100%;' /></div></td>";
	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.seltr');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('seltr');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
<script>
    function formcheck_2(form){


        return true;

    }

</script>
{% endblock %}

{% block mMul_Page_4 %}
<div class="panel-body">
    <div class="row">

        <div class="form-group">
            <label class="col-sm-3 control-label">订单包邮金额(元):</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="use_money" value="{{item.use_money}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">普通订单关闭时间(分钟):</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="close_time" value="{{item.close_time}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">活动订单关闭时间(分钟):</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="close_time_pk" value="{{item.close_time_pk}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">订单确认收货时间(天):</label>
            <div class="col-sm-3">
                <input type="number" class="form-control"  name="take_day" value="{{item.take_day or '1'}}" onkeyup="value=value.replace(/[^\d]/g,'')"/>
            </div>
        </div>

    </div>
    <div class="row">
        <div class="col-sm-12">
            <label ><b style="color:#333333;">订单模板消息ID:</b></label>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" >订单取消通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="cancel_id" value="{{item.cancel_id}}"/>
            </div>
            <label class="col-sm-2 control-label" >取消通知跳转页面:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control" name="cancel_url" value="{{item.cancel_url}}"
                       placeholder="如：pages/pages/home/home"/>
            </div>
            <a type="button" class="btn btn-success btn-sm" onclick="show_template(1)">取消通知模板</a>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单发货通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="send_id" value="{{item.send_id}}"/>
            </div>
            <label class="col-sm-2 control-label">发货通知跳转页面:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control" name="send_url" value="{{item.send_url}}"
                       placeholder="如：pages/pages/home/home"/>
            </div>
            <a type="button" class="btn btn-success btn-sm" onclick="show_template(2)">发货通知模板</a>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单评价通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="evaluate_id" value="{{item.evaluate_id}}"/>
            </div>
             <label class="col-sm-2 control-label">评价通知跳转页面:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control" name="evaluate_url" value="{{item.evaluate_url}}"
                       placeholder="如：pages/pages/home/home"/>
            </div>
            <a type="button" class="btn btn-success btn-sm" onclick="show_template(3)">评价通知模板</a>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label">订单完成通知:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="complete_id" value="{{item.complete_id}}"/>
            </div>
            <label class="col-sm-2 control-label">完成通知跳转页面:</label>
            <div class="col-sm-3">
                <input type="text" class="form-control" name="complete_url" value="{{item.complete_url}}"
                       placeholder="如：pages/pages/home/home"/>
            </div>
            <a type="button" class="btn btn-success btn-sm" onclick="show_template(4)">完成通知模板</a>
        </div>
    </div>
    <div class="row">

        <div class="col-sm-12">
            <div class="title_comm"><b style="color:#333;">订单配送方式</b>
                {#
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
                #}
            </div>
        </div>

        <div class="col-sm-12">
            <table class="table table-bordered addRowtb" >
                <thead>
                    <tr bgcolor="#ffffff">
                        <th class="col-sm-1" style="text-align:center;">运送方式</th>
                        <th class="col-sm-1" style="text-align:center;">是否包邮</th>
                        <th class="col-sm-1" style="text-align:center;">计价方式</th>
                        <th class="col-sm-5" style="text-align:center;">运费设置</th>
                        <th class="col-sm-1" style="text-align:center;">是否启用</th>
                        <th class="col-sm-1" style="text-align:center;">是否默认</th>
                    </tr>
                </thead>
                <tbody id="peisong">
                {%if detail%}
                    {% for r in detail%}
                    <tr class="alert-warning">
                        {%if r.c_id|string=='0'%}
                        <td>
                            <input type="hidden" name="lid" value="{{r.id}}">
                            <input type="hidden" name="c_id" value="0" />
                            <input type="text" name="cname" value="{{r.cname}}" class="form-control"  readonly/>
                        </td>

                        <td>
                            <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                                <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                                <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                            </select>
                        </td>
                        <td>
                            <select name="counts" class="form-control" id='set_mail_1'>
                                <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                                <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                            </select>
                        </td>

                        <td>
                            <div id='set_mail_2'>
                            <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                            <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                            每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                            <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                            </div>
                        </td>
                        <td>
                            <input type="hidden" name="status_str" value="">
                            <select name="status" class="form-control">
                                <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                                <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                            </select>

                        </td>
                        <td>
                            <input type="checkbox" name="default" value="0" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                        </td>
                        {%endif%}
                    </tr>
                    <tr class="alert-warning">
                        {%if r.c_id|string=='1'%}
                        <td>
                            <input type="hidden" name="lid" value="{{r.id}}">
                            <input type="hidden" name="c_id" value="1" />
                            <input type="text" name="cname" value="{{r.cname}}" class="form-control" readonly>
                        </td>

                        <td>
                            <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                                <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                                <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                            </select>
                        </td>
                        <td>
                            <select name="counts" class="form-control" id='set_mail_1'>
                                <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                                <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                            </select>
                        </td>

                        <td>
                            <div id='set_mail_2'>
                            <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                            <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                            每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                            <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                            </div>
                        </td>
                        <td>
                            <select name="status" class="form-control">
                                <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                                <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                            </select>
                        </td>
                        <td>
                            <input type="checkbox" name="default" value="1" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                        </td>
                        {%endif%}
                    </tr>
                    <tr class="alert-warning">
                        {%if r.c_id|string=='2'%}
                        <td>
                            <input type="hidden" name="lid" value="{{r.id}}">
                            <input type="hidden" name="c_id" value="2" />
                            <input type="text" name="cname" value="{{r.cname}}" class="form-control" readonly>
                        </td>

                        <td>
                            <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                                <option value="0" {{' selected="selected"' if r.is_mail|string == '0'}}>不包邮</option>
                                <option value="1" {{' selected="selected"' if r.is_mail|string == '1'}}>包邮</option>
                            </select>
                        </td>
                        <td>
                            <select name="counts" class="form-control" id='set_mail_1'>
                                <option value="0" {{' selected="selected"' if r.counts|string == '0'}}>按件</option>
                                <option value="1" {{' selected="selected"' if r.counts|string == '1'}}>按重量</option>
                            </select>
                        </td>

                        <td>
                            <div id='set_mail_2'>
                            <input type="number" name="piece" value="{{r.piece}}" style="width:50px;" />件(KG)内
                            <input type="number" name="only_money" value="{{r.only_money}}" style="width:50px;" />元，
                            每增加<input type="number" name="add_piece" value="{{r.add_piece}}" style="width:50px;" />件(KG),增加运费
                            <input type="number" name="add_money" value="{{r.add_money}}" style="width:50px;" />元
                            </div>
                        </td>
                        <td>
                            <select name="status" class="form-control">
                                <option value="0" {{' selected="selected"' if r.status|string == '0'}}>否</option>
                                <option value="1" {{' selected="selected"' if r.status|string == '1'}}>是</option>
                            </select>
                        </td>
                        <td>
                            <input type="checkbox" name="default" value="2" onclick="set_default(this)" {{' checked="checked"' if r.is_default|string == '1'}}/>
                        </td>
                        {%endif%}
                    </tr>
                    {%endfor%}
                {%else%}

                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="" />
                        <input type="hidden" name="c_id" value="0" />
                        <input type="text" name="cname" value="快递配送" class="form-control"  readonly/>
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>

                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <input type="hidden" name="status_str" value="">
                        <select name="status" class="form-control">
                            <option value="0" >否</option>
                            <option value="1" >是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="0" onclick="set_default(this)" />
                    </td>

                </tr>
                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="" />
                        <input type="hidden" name="c_id" value="1" />
                        <input type="text" name="cname" value="上门自提" class="form-control" readonly/>
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0" >否</option>
                            <option value="1">是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="1" onclick="set_default(this)"/>
                    </td>

                </tr>
                <tr class="alert-warning">

                    <td>
                        <input type="hidden" name="lid" value="" />
                        <input type="hidden" name="c_id" value="2" />
                        <input type="text" name="cname" value="无需配送" class="form-control" readonly />
                    </td>

                    <td>
                        <select name="is_mail" class="form-control" onchange='set_is_mail(this)'>
                            <option value="0" >不包邮</option>
                            <option value="1" selected="selected">包邮</option>
                        </select>
                    </td>
                    <td>
                        <select name="counts" class="form-control" id='set_mail_1'>
                            <option value="0" >按件</option>
                            <option value="1" >按重量</option>
                        </select>
                    </td>

                    <td>
                        <div id='set_mail_2'>
                        <input type="number" name="piece" value="" style="width:50px;" />件(KG)内
                        <input type="number" name="only_money" value="" style="width:50px;" />元，
                        每增加<input type="number" name="add_piece" value="" style="width:50px;" />件(KG),增加运费
                        <input type="number" name="add_money" value="" style="width:50px;" />元
                        </div>
                    </td>
                    <td>
                        <select name="status" class="form-control">
                            <option value="0">否</option>
                            <option value="1">是</option>
                        </select>
                    </td>
                    <td>
                        <input type="checkbox" name="default" value="2" onclick="set_default(this)" />
                    </td>
                </tr>

                {%endif%}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>

function show_template(id){
    content_html='<div class="col-sm-10">';
            content_html+='<img src="static/asset/images/'+id+'.png">';

            content_html+='</div>';

            layer.open({
                type: 1,
                skin: 'layui-layer-rim', //加上边框
                area: ['32rem;', '40rem;'], //宽高
                content: content_html,
                title: "模板",
            });


}
$(function(){
    var tr =$('#peisong').find('tr');
	for(var i = 0;i < tr.length;i++){
        var firstTdText = tr.eq(i).find('td').eq(1).find('select').val();
        if(firstTdText=='1'){
            tr.eq(i).find('#set_mail_1').hide();
            tr.eq(i).find('#set_mail_2').hide();
        }else{
            tr.eq(i).find('#set_mail_1').show();
            tr.eq(i).find('#set_mail_2').show();
        }

    }

 });
function set_is_mail(obj){
    var tr =$('#peisong').find('tr');
    var index=tr.index($(obj).closest("tr"));
    var a=obj.value;
    if (a=='0'){
        tr.eq(index).find('#set_mail_1').show();
        tr.eq(index).find('#set_mail_2').show();
        tr.eq(index).find('td').eq(3).find('input').val('');
    }else{
        tr.eq(index).find('#set_mail_1').hide();
        tr.eq(index).find('#set_mail_2').hide();
        tr.eq(index).find('td').eq(3).find('input').val('');
    }
}

function set_default(obj){

    if(obj.checked){
         $('input[name=default]').prop('checked', false);
         $(obj).prop('checked',true);
    }

}
function add_r(tablename){

	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'><input type='hidden' name='lid' value='' />";
	html+="<input type='text' name='cname' value='' class='form-control'/></td>";

	html+="<td onclick='clickR(this);'><select name='is_mail'  class='form-control' onchange='set_is_mail(this)'>";
    html+="<option value='0'>不包邮</option>";
    html+="<option value='1'>包邮</option>";
    html+="</select></td>";

	html+="<td onclick='clickR(this);'><select name='counts'  class='form-control' id='set_mail_1'>"
	html+="<option value='0'>按件</option>";
    html+="<option value='1'>按重量</option>";
    html+="</select></td>";

	html+="<td onclick='clickR(this);'><div id='set_mail_2'>"
	html+='<input type="number" name="piece" value=""   style="width:50px;" />件(KG)内';
	html+='<input type="number" name="only_money" value=""   style="width:50px;" />元，<br>';
	html+='每增加<input type="number" name="add_piece" value=""  style="width:50px;"/>件(KG),';
    html+='增加运费<input type="number" name="add_money" value=""  style="width:50px;" />元';
	html+="</div></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}

function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('alert-warning');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
<script>
    function formcheck_2(form){
        var take_day = $('input[name=take_day]').val();
        if (take_day==''){
            layer.alert('订单确认收货时间至少为1天，请修改！')
            return false;
        }
        if (take_day<1){
            layer.alert('订单确认收货时间至少为1天，请修改！')
            return false;
        }

        return true;

    }

</script>
{% endblock %}


{% block mMul_Page_5 %}
<link href="static/web-uploader/css/uploader-image.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="static/web-uploader/js/Q.js"></script>
<script type="text/javascript" src="static/web-uploader/js/Q.Uploader.js"></script>
<script type="text/javascript" src="static/web-uploader/js/Q.Uploader.UI.Image.js"></script>
<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">小程序appid:</b></label>
            <div class="col-sm-6">
                <input type="text" class="form-control"  name="appid" value="{{item.appid}}"/>(会被加密保存)
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">小程序secret:</b></label>
            <div class="col-sm-6">
                <input type="text" class="form-control"  name="secret" value="{{item.secret}}" style="width:300px;"/>(会被加密保存)
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">微信支付商户号:</b></label>
            <div class="col-sm-4">
                 <input type="text" class="form-control"  name="mchid" value="{{item.mchid}}"/>(会被加密保存)
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">微信支付秘钥:</b></label>
            <div class="col-sm-8">
                <input type="text" class="form-control"  name="mchkey" value="{{item.mchkey}}" style="width:300px;"/>(会被加密保存)
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">微信支付证书(cert.pem):</label>
            <div class="col-sm-1">

                <div class="row">
                    <div id="container" style="position: relative;">
                        <a id="pickfiles"  style="position: relative; z-index: 1;">[选择本地文件]</a>
                    </div>
                </div>
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control" name="certpem" value="{{item.certpem}}" readonly/>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label">微信支付证书(key.pem):</label>
            <div class="col-sm-1">

                <div class="row">
                    <div id="containera" style="position: relative;">
                        <a id="pickfilesa"  style="position: relative; z-index: 1;">[选择本地文件]</a>
                    </div>
                </div>

            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control" name="keypem" value="{{item.keypem}}" readonly/>
            </div>
        </div>
    </div>

</div>
<script>

	var ids = new Array("pickfiles","pickfilesa");
	var divs = new Array("logo","share");
    var hinames = new Array("certpem","keypem");

    $.each(ids,function(i,n){
        var self = this.toString();
        //实例化一个plupload上传对象
        var Uploader = Q.Uploader,
        formatSize = Q.formatSize,
        boxView = document.getElementById(""+divs[i]+"")
        var uploader = new Uploader({
            url: '/upload?viewid={{viewid}}&part=Pem',
            target: document.getElementById(""+self+""),
            //view: boxView,//如果去掉这个，会导致压缩效果不好
            //将auto配置为false以手动上传
            auto: true,
            dataType: "json",
            allows: ".pem",
            upName: "file",

            on: {
                //添加之前触发
                add: function (task) {
                	layer.load()
                    if (task.disabled) return layer.alert("允许上传的文件格式为：" + this.ops.allows);
                },
                upload: function (task) {
                	layer.load()
                },
                complete: function(task){
                    var jsons=task.json;
                    if(jsons){
                        $("#"+divs[i]+"").html('');
                        var innerDivHtml = '<img src="'+ task.json.url  +'" class="col-sm-12">';
                        $("#"+divs[i]+"").append(innerDivHtml);
                        $('input[name='+hinames[i]+']').val(task.json.url);
                        layer.closeAll()
                    }else{
                        //layer.alert('上传图片故障！')
                        layer.closeAll()
                    }
                }
            }
        });
        uploader.start();
    });

</script>
<script>
    function formcheck_2(form){


        return true;

    }

</script>
{% endblock %}

{% block mMul_Page_6 %}
<div class="panel-body">
    <div class="row">

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员升级方式:</b></label>

            <div class="col-sm-3">
                <select name="up_type"  class="form-control" onchange="set_up_type(this)">
				<option value="1"{{' selected="selected"' if item.up_type|string == '1'}}>付费升级</option>
				<option value="2"{{' selected="selected"' if item.up_type|string == '2'}}>购物升级</option>
			</select>
            </div>
        </div>
        <div class="form-group" id="up_type_3">
            <label class="col-sm-2 control-label"><b style="color:#333333;">年费会员价格(元):</b></label>
            <div class="col-sm-3">
                 <input type="number" class="form-control"  name="vip_price" value="{{item.vip_price}}"/>
            </div>
        </div>
        <div class="form-group" id="up_type_1">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员折扣百分比(%):</b></label>
            <div class="col-sm-3">
                 <input type="number" class="form-control"  name="discount" value="{{item.discount}}"/>
            </div>
        </div>
        <div class="form-group" id="up_type_4">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员每年可省(元):</b></label>
            <div class="col-sm-3">
                 <input type="number" class="form-control"  name="vip_sale" value="{{item.vip_sale}}"/>
            </div>
        </div>
    </div>

    <br>
    <div class="row" id="up_type_2" style="display:none;">

        <div class="col-sm-12">
            <div class="title_comm"><span class="block_blue"></span><b style="color:#333;">会员级别设置(名称空白的行不会保存)</b>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:60px;">序号</th>
                        <th style="text-align:center;width:260px;">级别名称</th>
                        <th style="text-align:center;width:250px;">升级价格(元)</th>
                        <th style="text-align:center;width:80px;">会员折扣百分比(%)</th>
                    </tr>
                </thead>
                <tbody>

                    {% for e in detail %}
                        <tr>
                        <td onclick='clickR(this);'>{{loop.index}}</td>
                        <td onclick='clickR(this);'>
                            <input type='hidden' name='lid' value='{{e.id}}' />
                            <input type='text' name='cname' value='{{e.cname}}' class='form-control' style='width:100%;'/></td>
                        <td onclick='clickR(this);'><input type='number' name='up_price' value='{{e.up_price}}'  class='form-control' style='width:100%;' /></td>
                        <td onclick='clickR(this);'><input type='number' name='level_discount' value='{{e.level_discount}}' class='form-control number' style='width:100%;ime-mode:Disabled;' /></td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>

</div>
<script>
$(function(){
    if($('select[name=up_type]').val()=='1'){
        $('#up_type_2').hide()
        $('#up_type_1').show()
        $('#up_type_3').show()
        $('#up_type_4').show()
    }else{
        $('#up_type_2').show()
        $('#up_type_1').hide()
         $('#up_type_3').hide()
         $('#up_type_4').hide()
    }
 });

function set_up_type(obj){
    var hid=obj.value;
    layer.confirm('变更会员升级方式会带来不可逆的后果,您确信要变更吗？', {
			btn: ['是','否'] //按钮
		}, function(index,layero){
			 layer.close(index)
			 if (hid=='1'){
                    $('#up_type_2').hide()
                    $('#up_type_1').show()
                    $('#up_type_3').show()
                    $('#up_type_4').show()
                }else{
                    $('#up_type_2').show()
                    $('#up_type_1').hide()
                    $('#up_type_3').hide()
                    $('#up_type_4').hide()
                }


		}, function(){
			if (hid=='1'){
                $('select[name=up_type]').val('2');
            }else{
               $('select[name=up_type]').val('1');
            }
		});

}
function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"</td>";
	html+="<td onclick='clickR(this);'><input type='hidden' name='lid' value='' /><input type='text' name='cname' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='up_price' value=''  class='form-control' style='width:100%;' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='level_discount' value='' class='form-control number' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.seltr');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('seltr');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
<script>
    function formcheck_2(form){


        return true;

    }

</script>
{% endblock %}

{% block mMul_Page_7 %}
<link rel="stylesheet" type="text/css" href="static/assets/liger/ligerUI/skins/Aqua/css/ligerui-all.css">
<link rel="stylesheet" type="text/css" href="static/assets/liger/ligerUI/skins/Aqua/css/ligerui-layout.css">
<link rel="stylesheet" type="text/css" href="static/assets/liger/ligerUI/skins/Aqua/css/ligerui-grid.css">
<link rel="stylesheet" type="text/css" href="static/assets/liger/ligerUI/skins/Aqua/css/ligerui-common.css">
<script type="text/javascript" src="static/assets/liger/ligerUI/js/core/base.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerTree.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerGrid.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerResizable.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerDialog.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerMenu.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerSpinner.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerDrag.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerFilter.js"></script>
<script type="text/javascript" src="static/assets/liger/ligerUI/js/plugins/ligerToolBar.js"></script>
<script src="static/assets/liger/ligerUI/js/plugins/ligerComboBox.js" type="text/javascript"></script>
<div class="panel-body">
    <div class="row">
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">首页赠送优惠券:</b></label>
            <input type="hidden" class="form-control"  name="return_ticket"  value="{{item.return_ticket}}" />
            <div class="col-sm-3">
                <input type="text" class="form-control"  name="return_ticket_str"  value="{{item.return_ticket_str}}" readonly="readonly"/>
            </div>
            <div class="col-sm-3">
                {{show_ticket}}
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">首页推荐商品设置:</b></label>

            <div class="col-sm-3">
                <select name="home_goods"  class="form-control" onchange="set_home_goods(this);">
                    <option value="0"{{' selected="selected"' if item.home_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.home_goods|string == '1'}}>全部推荐商品</option>
                    <option value="2"{{' selected="selected"' if item.home_goods|string == '2'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="home_page" style="display:none">
                <div class="col-sm-6">
                 <input type="text" class="form-control"  name="goods_id" value="{{item.home_goods_id}}" readonly="readonly"/>
                </div>
                <div class="col-sm-2">
                    {{show_Goods}}
                </div>
            </div>

        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">购物车推荐商品设置:</b></label>

            <div class="col-sm-3">
                <select name="shop_goods"  class="form-control" onchange="set_shop_goods(this);">
                    <option value="0"{{' selected="selected"' if item.shop_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.shop_goods|string == '1'}}>全部推荐商品</option>
                    <option value="2"{{' selected="selected"' if item.shop_goods|string == '2'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="shop_cart" style="display:none">
                <div class="col-sm-6">
                 <input type="text" class="form-control"  name="goods_ids" value="{{item.shop_goods_id}}" readonly="readonly"/>
                </div>
                <div class="col-sm-2">
                {{show_Goods_id}}
                    </div>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">订单页推荐商品设置:</b></label>
            {#<input type="hidden"  name="order_goods_str" value="{{item.order_goods_str or '全部商品'}}"/>#}
            <div class="col-sm-3">
                <select name="order_goods"  class="form-control" onchange="set_order_goods(this);">
                    <option value="0"{{' selected="selected"' if item.order_goods|string == '0'}}>全部商品</option>
                    <option value="1"{{' selected="selected"' if item.order_goods|string == '1'}}>全部推荐商品</option>
                    <option value="2"{{' selected="selected"' if item.order_goods|string == '2'}}>指定商品</option>
                </select>
            </div>
            <div class="col-sm-6" id="shop_order" style="display:none">
                <div class="col-sm-6">
                 <input type="text" class="form-control"  name="order_goods_id" value="{{item.order_goods_id}}" readonly="readonly"/>
                </div>
                <div class="col-sm-6">
                {{order_Goods_id}}
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label"><b style="color:#333333;">购物车页信息设置(多个用逗号隔开):</b></label>
            <div class="col-sm-8">
                <input type="text"  name="shop_cart_memo" class="form-control" value="{{item.shop_cart_memo}}" style="width:500px;"/>
            </div>

        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label"><b style="color:#333333;">菜单页面搜索关键词设置(多个用逗号隔开):</b></label>
            <div class="col-sm-8">
                <input type="text"  name="menu_memo" class="form-control" value="{{item.menu_memo}}" style="width:500px;"/>
            </div>

        </div>
    </div>
</div>
<script>

$(function(){

    if($('select[name=home_goods]').val()=='2'){
        $('#home_page').show()
    }else{
        $('#home_page').hide()
    }

    if($('select[name=shop_goods]').val()=='2'){
        $('#shop_cart').show()
    }else{
        $('#shop_cart').hide()
    }

    if($('select[name=order_goods]').val()=='2'){
        $('#shop_order').show()
    }else{
        $('#shop_order').hide()
    }
 });


function set_home_goods(obj){
    var hid=obj.value;
    if (hid=='1'){

        $('#home_page').hide()
        $('input[name=goods_id]').val('0')
    }else if (hid=='2'){

        $('#home_page').show()
        $('input[name=goods_id]').val('')
    }
    else{

       $('#home_page').hide()
       $('input[name=goods_id]').val('0')
    }
}

function set_shop_goods(obj){
    var sid=obj.value;
    if (sid=='1'){

        $('#shop_cart').hide()
        $('input[name=goods_ids]').val('0')
    }else if (sid=='2'){

        $('#shop_cart').show()
        $('input[name=goods_ids]').val('')
    }
    else{

       $('#shop_cart').hide()
       $('input[name=goods_ids]').val('0')
    }
}

function set_order_goods(obj){
    var oid=obj.value;
    if (oid=='1'){

        $('#shop_order').hide()
        $('input[name=order_goods_id]').val('0')
    }else if (oid=='2'){

        $('#shop_order').show()
        $('input[name=order_goods_id]').val('')
    }
    else{

       $('#shop_order').hide()
       $('input[name=order_goods_id]').val('0')
    }
}

function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"

	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='memo' value='' class='form-control' style='width:100%;'/></td>";
	//html+="<td onclick='clickR(this);'><input type='text' name='up_price' value=''  class='form-control' style='width:100%;' /></td>";
	//html+="<td onclick='clickR(this);'><input type='text' name='level_discount' value='' class='form-control number' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.alert-warning');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('alert-warning');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
<script>
    function formcheck_2(form){
        if($('select[name=home_goods]').val()=='2'){
            if ($('input[name=goods_id]').val()==''){
                layer.msg('首页推荐商品设置必须设置商品')
                return false;
            }
        }

        if($('select[name=shop_goods]').val()=='2'){
            if ($('input[name=goods_ids]').val()==''){
                layer.msg('购物车推荐商品设置必须设置商品')
                return false;
            }
        }

        if($('select[name=order_goods]').val()=='2'){
            if ($('input[name=order_goods_id]').val()==''){
                layer.msg('订单页推荐商品设置必须设置商品')
                return false;
            }
        }

        return true;

    }

</script>
{% endblock %}



{% block mMul_Page_8 %}
<div class="panel-body">
    <div class="row">
        <div class="form-group" >
            <label class="col-sm-2 control-label"><b style="color:#333333;">非会员购物返积分比例:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="integral" value="{{item.integral}}"/>
                <font color="red">每消费1元返多少积分</font>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">会员购物返积分比例:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="vip_integral" value="{{item.vip_integral}}"/>
                <font color="red">每消费1元返多少积分</font>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">新用户注册送多少积分:</b></label>
            <div class="col-sm-2">
                 <input type="number" class="form-control"  name="new_score" value="{{item.new_score}}"/>
            </div>
        </div>
    </div>

    <br>
    <div class="row" style="display:;">

        <div class="col-sm-6">
            <div class="title_comm"><span class="block_blue"></span><b style="color:#333;">积分签到规则(签到天数空白的行不会保存,最多可以添加7条)</b>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:60px;">序号</th>
                        <th style="text-align:center;width:260px;">签到天数</th>
                        <th style="text-align:center;width:250px;">赠送积分</th>

                    </tr>
                </thead>
                <tbody>

                    {% for e in detail %}
                        <tr>
                        <td onclick='clickR(this);'>{{loop.index}}</td>
                        <td onclick='clickR(this);'>
                            <input type='hidden' name='lid' value='{{e.id}}' />
                            <input type='number' name='days' value='{{e.days}}'  class='form-control' style='width:100%;' />
                        </td>
                        <td onclick='clickR(this);'><input type='number' name='score' value='{{e.score}}' class='form-control number' style='width:100%;ime-mode:Disabled;' /></td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>

</div>
<script>
$(function(){

 });


function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"
    if (rowNo>=8){
    return false;
    }
	html+="<td onclick='clickR(this);'>"+rowNo+"<input type='hidden' name='lid' value='' /></td>";
	html+="<td onclick='clickR(this);'><input type='number' name='days' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='number' name='score' value=''  class='form-control' style='width:100%;' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.seltr');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('seltr');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>
{% endblock %}


{% block mMul_Page_9 %}
<div class="panel-body">
    <div class="row">

        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">是否允许充值:</b></label>
            <div class="col-sm-2">
                <input type="hidden"  name="topup_str" class="form-control" value="{{item.topup_str or '否'}}"/>
				<select name="topup" class="form-control" onchange='set_topup(this)'>
                    <option value="0" {{' selected="selected"' if item.topup|string == '0'}}>否</option>
                    <option value="1" {{' selected="selected"' if item.topup|string == '1'}}>是</option>
                </select>
            </div>
        </div>

    </div>

    <br>
    <div class="row" id="up_type_2" style="display:;">

        <div class="col-sm-6">
            <div class="title_comm"><span class="block_blue"></span><b style="color:#333;">充值赠送金额设置(充值金额空白的行不会保存,最多可以添加7条)</b>
                <span style="float:right">
                    <button class="btn btn-xs btn-info" type="button" onclick="add_r('detail')" title="增加">
                        <i class="fa fa-plus"></i>
                    </button>
                    <button class="btn btn-xs btn-warning" type="button" onclick="del_r('detail')" title="删除">
                        <i class="fa fa-trash-o"></i>
                    </button>
                </span>
            </div>
            <table class="table table-bordered addRowtb" name="detail">
                <thead>
                    <tr bgcolor="#ffffff">
                        <th style="text-align:center;width:60px;">序号</th>
                        <th style="text-align:center;width:260px;">充值金额(元)</th>
                        <th style="text-align:center;width:250px;">赠送金额(元)</th>

                    </tr>
                </thead>
                <tbody>

                    {% for e in detail %}
                        <tr>
                        <td onclick='clickR(this);'>{{loop.index}}</td>
                        <td onclick='clickR(this);'>
                            <input type='hidden' name='lid' value='{{e.id}}' />
                            <input type='text' name='add_money' value='{{e.add_money}}'  class='form-control' style='width:100%;' />
                        </td>
                        <td onclick='clickR(this);'><input type='text' name='giving' value='{{e.giving}}' class='form-control number' style='width:100%;ime-mode:Disabled;' /></td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>
    </div>

</div>
<script>
$(function(){
    if($('select[name=topup]').val()=='0'){
        $('#up_type_2').hide()

    }else{
        $('#up_type_2').show()

    }

    if($('select[name=drawal]').val()=='1'){
        $('#up_type_1').show()
    }else{
        $('#up_type_1').hide()

    }
 });
function set_topup(obj){
    var hids=obj.value;
    if (hids=='1'){
        $('input[name=topup_str]').val('是');
        $('#up_type_2').show()
    }else{
        $('input[name=topup_str]').val('否');
        $('#up_type_2').hide()
    }
}

function set_drawal(obj){
    var hid=obj.value;
    if (hid=='1'){
        $('input[name=drawal_str]').val('是');
        $('#up_type_1').show()
    }else{
        $('input[name=drawal_str]').val('否');
        $('#up_type_1').hide()
    }
}

function add_r(tablename){

	var a= "show_option(this,'serlib','cgpm2')";
	var obj = $("[name="+tablename+"]");
	var tr = obj.find('tbody').find('tr');
	var rowNo = tr.length+1;
	html="<tr>"
    if (rowNo>=8){
        return false;
    }
	html+="<td onclick='clickR(this);'>"+rowNo+"</td>";
	html+="<td onclick='clickR(this);'><input type='hidden' name='lid' value='' /><input type='text' name='add_money' value='' class='form-control' style='width:100%;'/></td>";
	html+="<td onclick='clickR(this);'><input type='text' name='giving' value=''  class='form-control' style='width:100%;' /></td>";

	html+="</tr>";
	obj.append(html);
}

function del_r(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr.seltr');
	seltr.remove();
	if (tablename=='detail'){
		setSerialNo(tablename);
	}
}


function clickR(obj){
	var tr=$(obj).parent();
	tr.addClass('seltr');
	var trindex=$($(obj).parent()).index();
	var otr=$($($(obj).parent()).parent()).find('tr:not(:eq('+trindex+'))');
	for (i=0;i<otr.length;i++){
		$(otr[i]).removeClass('seltr');
	}
}

function setSerialNo(tablename){
	var seltr=$("[name="+tablename+"]").find('tbody').find('tr');
	for (i=0;i<seltr.length;i++){
		$(seltr[i]).find('td:first-child').html(i+1);
	}
}

</script>

{% endblock %}
{% block page_script %}

<style>
        .seltr {
            background: #deba12 !important;
        }
        .seltr td {
            background: #deba12 !important;
        }


</style>
{% endblock %}

{% block mMul_Page_10 %}
<div class="panel-body">
    <div class="row">
        <div class="form-group" >
            <label class="col-sm-2 control-label"><b style="color:#333333;">用户ID:</b></label>
            <div class="col-sm-2">
                 <input type="text" class="form-control"  name="ebusinessid" value="{{item.ebusinessid}}"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label"><b style="color:#333333;">API key:</b></label>
            <div class="col-sm-2">
                 <input type="text" class="form-control"  name="appkey" value="{{item.appkey}}" />
            </div>
        </div>


    </div>


</div>

<script>


    function formcheck_2(form){

        var ebusinessid = $('input[name=ebusinessid]').val();
        var appkey = $('input[name=appkey]').val();


        if (ebusinessid==''){
            layer.alert('用户ID不能为空！')
            return false;
        }
        if (appkey==''){
            layer.alert('appkey不能为空！')
            return false;
        }

        return true;

    }

</script>
{% endblock %}

{% block mMul_Page_11 %}
{% endblock %}